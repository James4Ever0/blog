<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Docker | Blog of James Brown</title>
  <meta name="author" content="James Brown">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Blog of James Brown"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/blog/atom.xml" title="Blog of James Brown" type="application/atom+xml">
  
  
    <link href="/blog/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/blog/css/themes/cerulean.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/highlight-default.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/comment.css" media="screen" type="text/css">
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-sham.min.js"></script>
  <![endif]-->

  <script src="/blog/js/jquery-2.0.3.min.js"></script>
  
  
  <!-- analytics -->
  



<meta name="generator" content="Hexo 7.0.0"></head>

<body>
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/blog/">Blog of James Brown</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/blog/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/blog/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/blog/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/blog/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
    <div class="content">
      

<!-- title -->
<div class="page-header page-header-inverse ">
  <h1 class="archive-title-category title title-inverse ">Docker</h1>
</div>

<div class="row page">
  <!-- cols -->
  
  <div class="col-md-9">
	

	  <div id="top_search"></div>

      
         <!-- display as entry -->
	     <div class="mypage">
	       
		     
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2024-07-21 </div>
			<div class="article-title"><a href="/blog/2024/07/21/7e278413-28ba-4422-8cd1-1145ab1c2f2c/" title="This article provides a comprehensive guide on building, uploading, and loading Docker images for Kubernetes-based microk8s or Minikube. Additionally, it covers the process of importing images specifically for lightweight K3s distribution that utilizes the Docker container runtime.">K8S Load Docker Image</a></div>
		</h3>
	


		     
<div class="entry">

  <div class="row">
	
	
		<p>first of all, you can build and upload docker image to registry.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker login</span><br><span class="line">docker build -t &lt;username&gt;/&lt;imagename&gt;:&lt;tag&gt; -f &lt;dockerfile&gt; &lt;resource_path&gt;</span><br><span class="line">docker push &lt;username&gt;/&lt;imagename&gt;:&lt;tag&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>you can upload to docker.io or microk8s provided local registry.</p>
<p><a target="_blank" rel="noopener" href="https://microk8s.io/docs/registry-built-in">https://microk8s.io/docs/registry-built-in</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># for microk8s the registry address is localhost:32000</span></span><br><span class="line">docker tag &lt;imagename&gt; &lt;registry_addr&gt;/&lt;imagename&gt;</span><br><span class="line">docker push &lt;registry_addr&gt;/&lt;imagename&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>you can also build image with minikube:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">minikube image build -t &lt;imagename&gt; -f &lt;dockerfile_path&gt; &lt;resource_path&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p>load image exported with <code>docker save &lt;image&gt;:&lt;tag&gt;</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ref: https://minikube.sigs.k8s.io/docs/commands/image/</span></span><br><span class="line"><span class="comment"># remember to set a tag to the image imported</span></span><br><span class="line"><span class="comment"># or set the imagePullPolicy to Never</span></span><br><span class="line"><span class="comment"># ref: https://iximiuz.com/en/posts/kubernetes-kind-load-docker-image/</span></span><br><span class="line">minikube image load &lt;image_filepath&gt;/&lt;docker_image_name&gt;</span><br><span class="line">microk8s images import &lt;image_filepath&gt;</span><br><span class="line">microk8s ctr image import &lt;image_filepath&gt;</span><br><span class="line">k3s ctr image import &lt;image_filepath&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://blog.scottlowe.org/2020/01/25/manually-loading-container-images-with-containerd/">https://blog.scottlowe.org/2020/01/25/manually-loading-container-images-with-containerd/</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.k3s.io/installation/registry-mirror#pushing-images">https://docs.k3s.io/installation/registry-mirror#pushing-images</a></p>
<hr>
<p>you can also configure k8s to use docker as container runtime instead.</p>
<p><a target="_blank" rel="noopener" href="https://github.com/canonical/microk8s/issues/287">https://github.com/canonical/microk8s/issues/287</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.k3s.io/advanced#using-docker-as-the-container-runtime">https://docs.k3s.io/advanced#using-docker-as-the-container-runtime</a></p>

	
	</div>
  <a type="button" href="/blog/2024/07/21/7e278413-28ba-4422-8cd1-1145ab1c2f2c/#more" class="btn btn-default more">Read More</a>
</div>

	       
		     
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2024-07-04 </div>
			<div class="article-title"><a href="/blog/2024/07/04/2fa65266-e8d2-46cc-827a-5f6a744295f9/" title="The text outlines several methods to keep a Docker container continuously operational using commands like &#39;docker run -d&#39;, &#39;tail -f /dev/null&#39;, &#39;sleep infinity&#39;, and &#39;nc -l -p &lt;port&gt;&#39;. These commands help maintain the Docker container&#39;s functionality and ensure that it remains running without stopping or terminating.">Keep Docker Container Running</a></div>
		</h3>
	


		     
<div class="entry">

  <div class="row">
	
	
		<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker run -d &lt;image_name&gt; <span class="built_in">tail</span> -f /dev/null</span><br><span class="line">docker run -d &lt;image_name&gt; <span class="built_in">sleep</span> infinity</span><br><span class="line">docker run -dt &lt;image_name&gt;</span><br><span class="line">docker run -dt &lt;image_name&gt; <span class="built_in">cat</span></span><br><span class="line">docker run -d &lt;image_name&gt; nc -l -p &lt;port&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

	
	</div>
  <a type="button" href="/blog/2024/07/04/2fa65266-e8d2-46cc-827a-5f6a744295f9/#more" class="btn btn-default more">Read More</a>
</div>

	       
		     
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2024-03-30 </div>
			<div class="article-title"><a href="/blog/2024/03/30/54412af5-1dc4-425c-9754-1ad0504e139d/" title="This article explains how to use Proot-Distro on Termux to install Kali and Blackarch Linux. It compares Podman with Docker for faster image pulling speed, discusses granting container permissions for network scanning commands, and suggests using Github searches for finding relevant Docker images. Additionally, it provides guidance on utilizing Kali and Blackarch Linux Docker images on Ubuntu with Docker and recommends updating installed Blackarch for better performance.">Hacker Virtual Machines, Containers</a></div>
		</h3>
	


		     
<div class="entry">

  <div class="row">
	
	
		<p>on termux you use <a target="_blank" rel="noopener" href="https://github.com/termux/proot-distro"><code>proot-distro</code></a> for installing kali and blackarch linux.</p>
<p>install via  <code>apt install proot-distro</code></p>
<hr>
<p>use podman over docker, since we do not need gpu here, and want faster pulling speed.</p>
<p>recent version of podman requires extra layer of domain&#x2F;index specification before searching and pulling images.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">podman search docker.io/kali</span><br><span class="line">podman pull docker.io/kalilinux/kali-rolling</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p>if you want to run network scanning commands like <code>nmap</code>, you would grant the container sufficient permissions:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">podman run --cap-add=NET_RAW --cap-add=NET_ADMIN --<span class="built_in">rm</span> -it docker.io/parrotsec/security</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p><a target="_blank" rel="noopener" href="https://docs.rapid7.com/metasploit/metasploitable-2-exploitability-guide/">metasploitable2</a>, <a target="_blank" rel="noopener" href="https://parrotsec.org/docs/cloud/parrot-on-docker/">parrot linux</a> also have docker images. more cybersecurity&#x2F;ctf related images to be found.</p>
<p>run this query in search engines:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">site:github.com cybersecurity docker images</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/VaultSEC/osint">https://github.com/VaultSEC/osint</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/PberAcademy/Dockerimages">https://github.com/PberAcademy/Dockerimages</a></p>
<hr>
<p>on ubuntu you use docker for pulling <a target="_blank" rel="noopener" href="https://www.kali.org/docs/containers/official-kalilinux-docker-images/">kali</a> and <a target="_blank" rel="noopener" href="https://github.com/BlackArch/blackarch-docker">blackarch</a> linux images. latest images are pushed to docker hub.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo docker pull kalilinux/kali-rolling</span><br><span class="line"><span class="comment"># kali-rolling does not contain all packages</span></span><br><span class="line"><span class="comment"># run inside container: apt update &amp;&amp; apt install -y kali-linux-headless</span></span><br><span class="line">sudo docker pull blackarchlinux/blackarch</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p>it is always recommend to update and upgrade the blackarch you installed.</p>

	
	</div>
  <a type="button" href="/blog/2024/03/30/54412af5-1dc4-425c-9754-1ad0504e139d/#more" class="btn btn-default more">Read More</a>
</div>

	       
		     
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2023-10-05 </div>
			<div class="article-title"><a href="/blog/2023/10/05/4df79ade-d538-4df2-9a6e-7840343648e1/" title="This article guides you through the process of configuring Docker to pull images from a specific mirror, such as baidubce.com, instead of the default docker.io. The article also explains that the configuration may not work until you explicitly pull from the specified mirror.">Force To Use Docker Mirror Instead Of Pulling From Docker.Io</a></div>
		</h3>
	


		     
<div class="entry">

  <div class="row">
	
	
		<p>even if you configure <code>/etc/docker/daemon.json</code> like this (note: you still need to do this):</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span> <span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span></span><br><span class="line"><span class="punctuation">[</span><span class="string">&quot;https://mirror.baidubce.com&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>it is not fully working until:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo -E docker pull mirror.baidubce.com/significantgravitas/auto-gpt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

	
	</div>
  <a type="button" href="/blog/2023/10/05/4df79ade-d538-4df2-9a6e-7840343648e1/#more" class="btn btn-default more">Read More</a>
</div>

	       
		     
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2023-07-30 </div>
			<div class="article-title"><a href="/blog/2023/07/30/d21793d1-6f30-4238-a2a5-a4377d1b8650/" title="This article provides a detailed explanation on how to set Docker container storage quota using the `--storage-opt` option with overlay on XFS, and offers examples with various storage drivers such as devmapper, zfs, and vfs. Additionally, it guides you through changing the `data-root` configuration in `/etc/docker/daemon.json` and editing the `/etc/fstab` file to further customize your Docker container&#39;s storage settings.">Setting Docker Container Storage Quota With Overlay And Different Storage Drivers</a></div>
		</h3>
	


		     
<div class="entry">

  <div class="row">
	
	
		<h1 id="Docker-container-storage-quota"><a href="#Docker-container-storage-quota" class="headerlink" title="Docker container storage quota"></a>Docker container storage quota</h1><p><code>--storage-opt</code> is supported only for overlay over xfs with ‘pquota’ mount option.</p>
<p>change data-root to somewhere else in <code>/etc/docker/daemon.json</code></p>
<p>edit <code>/etc/fstab</code> and add our xfs block on new line (find uuid using blkid)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --storage-opt size=10M --<span class="built_in">rm</span> -it alpine</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>when using <a target="_blank" rel="noopener" href="https://docs.docker.com/storage/storagedriver/device-mapper-driver">devmapper</a> make sure size is greater than 10G (default)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --storage-opt size=11G --r<span class="string">&#x27;m -it alpine</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<p>zfs, vfs (not a unionfs, but for testing) storage drivers also supports disk quota. you may use it by changing <code>data-root</code> to the related storage device.</p>

	
	</div>
  <a type="button" href="/blog/2023/07/30/d21793d1-6f30-4238-a2a5-a4377d1b8650/#more" class="btn btn-default more">Read More</a>
</div>

	       
		     
	
	<!-- display as entry -->	
		<h3 class="title">
			<div class="date"> 2022-12-11 </div>
			<div class="article-title"><a href="/blog/2022/12/11/ac63ba4a-94ee-4d29-8569-f773120915fc/" title="This article offers solutions for various Docker-related problems, including reducing image size, diagnosing and resolving connectivity issues, managing volumes effectively, and assigning IP addresses to containers. It further explains how to determine the IP address of a container using the `docker inspect` command, which can be useful when communicating without port mappings.">Docker Usage Issues</a></div>
		</h3>
	


		     
<div class="entry">

  <div class="row">
	
	
		<p>use slim toolkit to shrink docker image size</p>
<hr>
<p>with iptable, you can constrain docker container network</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo iptables -I DOCKER-USER -d &lt;ip_range&gt; -j DROP</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>it does not work if you block all local ip ranges.</p>
<hr>
<p>to use host provided proxy servers, one can set environment variables before running containers.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -e http_proxy=&lt;proxy_addr&gt; -e https_proxy=&lt;proxy_addr&gt; -e all_proxy=&lt;proxy_addr&gt; -e no_proxy=&lt;bypass_addrs&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>or better, use <a target="_blank" rel="noopener" href="https://github.com/tun2proxy/tun2proxy"><code>tun2proxy</code></a> (linux only)</p>
<p>run server:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -v /dev/net/tun:/dev/net/tun --sysctl net.ipv6.conf.default.disable_ipv6=0 --cap-add NET_ADMIN --name tun2proxy tun2proxy --proxy &lt;proto&gt;://[username[:password]@]host:port</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>container forced to use proxy:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --network <span class="string">&quot;container:tun2proxy&quot;</span> &lt;image_name&gt;[:tag]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p>with docker for mac, you can use the following domain name to get host and gateway ip:</p>
<ul>
<li><p>host.docker.internal</p>
</li>
<li><p>gateway.docker.internal</p>
</li>
</ul>
<p>for podman:</p>
<ul>
<li><p>host.containers.internal</p>
</li>
<li><p>gateway.containers.internal</p>
</li>
</ul>
<hr>
<p>latest docker mirror:</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/704011584">https://zhuanlan.zhihu.com/p/704011584</a></p>
<hr>
<p>login mysql with empty password then execute command to make it remotely available:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot --password= -e <span class="string">&quot;grant all privileges on *.* to root@&#x27;%&#x27; identified by &#x27;&#x27; with grant option; commit;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>create volume and attach volume to container, since containers will be reset after system restarts.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker volume create &lt;volume_name&gt;</span><br><span class="line">docker run -it -d --<span class="built_in">rm</span> -v &lt;volume_name&gt;:&lt;container_mountpoint&gt; --name &lt;container_name&gt; &lt;image_name&gt;</span><br><span class="line">docker volume inspect &lt;volume_name&gt; <span class="comment"># get info on created volume</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>when using mindsdb, it sucks because having bad pypi mirrors.</p>
<p>set pip index url globally:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip config <span class="built_in">set</span> global.index-url https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>or pass it as environment variable:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -d -e PIP_INDEX_URL=https://pypi.tuna.tsinghua.edu.cn/simple -n &lt;container_name&gt; &lt;image_name&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>if you want to save container states into images, use <code>docker commit &lt;container_name&gt; &lt;image_name&gt;[:image_tag]</code></p>
<p>Keep in mind that the <code>docker commit</code> command only saves the changes made to a container’s file system. It does not save any changes made to the container’s settings or network configurations. To save all changes made to a container, including settings and network configurations, you can use the <code>docker export</code> and <code>docker import</code> commands instead.</p>
<p>when exporting ports, if not specifying host ip, you cannot reach the service inside the container. do this instead: <code>docker run -p 0.0.0.0:&lt;host_port&gt;:&lt;container_port&gt; &lt;rest_commands&gt;</code></p>
<p>it seems to be the proxy (fastgithub). disable http proxy so we can connect to container again, or use clash to make rules to let “localhost” or subnet requests passing through.</p>
<p>if you want to change ip routings or some other configurations passed when <code>docker run</code>, you need to change the file called <code>hostconfig.json</code> located in <code>/var/lib/docker/containers/&lt;container_id&gt;</code> with <code>PortBindings</code> sections. you stop the container first. find and change the config file then start it. <a target="_blank" rel="noopener" href="https://ahelpme.com/software/docker/docker-change-the-port-mapping-of-an-existing-container/#:~:text=Here%20is%20the%20whole%20procedure%3A%201%20Stop%20the,Docker%20container%20service.%205%20Start%20the%20docker%20container.">tutorial</a></p>
<p>seems not working. fuck.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&quot;PortBindings&quot;: &#123;</span><br><span class="line">&quot;80/tcp&quot;: [</span><br><span class="line">&#123;</span><br><span class="line">&quot;HostPort&quot;: &quot;8080&quot;</span><br><span class="line">&#125;</span><br><span class="line">],</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>containers can only contact each other if they share the same network. better give unique ip for each container within same network. it can also use container name as host name instead of static ip. <a target="_blank" rel="noopener" href="https://maximorlov.com/4-reasons-why-your-docker-containers-cant-talk-to-each-other/">tutorial</a></p>
<p>create a network (not overlapping with anything shown in <code>ifconfig</code>, notice the subnet mask):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker network create --subnet=172.18.0.0/16 &lt;network_name&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>start container with given network (again not overlapping with addresses in <code>ifconfig</code>, not the starting address):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --<span class="built_in">rm</span> -d -it --net &lt;network_name&gt; --ip &lt;ipaddress&gt; --name &lt;container_name&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>to check what ip the container is at:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker inspect &lt;container_id/container_name&gt; | grep IPAddress</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>now you might can talk to the container without port mappings.</p>

	
	</div>
  <a type="button" href="/blog/2022/12/11/ac63ba4a-94ee-4d29-8569-f773120915fc/#more" class="btn btn-default more">Read More</a>
</div>

	       
	     </div>
	     <div>
	       <center>
	         <div class="pagination">
<ul class="pagination">
	 
</ul>
</div>

	       </center>
	     </div>	
      

</div> <!-- col-md-9/col-md-12 -->


<div class="col-md-3">
	<div id="sidebar">
	
			
  <div id="site_search">
   <div class="form-group">
    <input type="text" id="local-search-input" name="q" results="0" placeholder="Search" class="st-search-input st-default-search-input form-control"/>
   </div>  
  <div id="local-search-result"></div>
  </div>


		
			
<div class="widget">
	<h4>Links</h4>
	<ul class="blogroll list-unstyled">
	
		<li><i class="fa fa-github"></i><a href="https://github.com/james4ever0/agi_computer_control/" title="Autonomous computer agent" target="_blank"]);">Project Cybergod</a></li>
	
		<li><i class="fa fa-github"></i><a href="https://github.com/james4ever0/pyjom/" title="Media content automation" target="_blank"]);">Project Pyjom</a></li>
	
		<li><i class="fa fa-github"></i><a href="https://github.com/james4ever0/prometheous/" title="Automated documentation, AI+IR(RAG)" target="_blank"]);">Project Prometheus</a></li>
	
		<li><i class="fa fa-github"></i><a href="https://github.com/james4ever0/pyjom/" title="Media Content Automation" target="_blank"]);">Project Pyjom</a></li>
	
		<li><i class="fa fa-github"></i><a href="https://github.com/james4ever0/my_blog_source/" title="Source code of my blog"" target="_blank"]);">Blog Source Code</a></li>
	
		<li><i class="fa fa-github"></i><a href="http://www.github.com/james4ever0" title="My Github account" target="_blank"]);">My Github</a></li>
	
		<li><i class="fa fa-book"></i><a href="https://samoyedsun.github.io/" title="Samoyedsun's Blog" target="_blank"]);">Samoyedsun&#39;s Blog</a></li>
	
		<li><i class="fa fa-book"></i><a href="http://atlant1c.cn/" title="Atlant1c's Blog" target="_blank"]);">Atlant1c&#39;s Blog</a></li>
	
		<li><i class="fa fa-book"></i><a href="https://www.gregoryuan.com/" title="Gregoryuan's Blog" target="_blank"]);">Gregoryuan&#39;s Blog</a></li>
	
		<li><i class="fa fa-book"></i><a href="https://yubingtao.netlify.app/" title="Yubingtao's Blog" target="_blank"]);">Yubingtao&#39;s Blog</a></li>
	
	</ul>
</div>


		
	</div> <!-- sidebar -->
</div> <!-- col-md-3 -->




    </div>
  </div>
  <div class="container-narrow">
    <footer> <p>
  &copy; 2024 James Brown
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/blog/js/jquery.imagesloaded.min.js"></script>
<script src="/blog/js/gallery.js"></script>
<script src="/blog/js/bootstrap.min.js"></script>
<script src="/blog/js/main.js"></script>
<script src="/blog/js/search.js"></script> 


<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/blog/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/blog/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>


<!-- syntax highlighting -->


</body>
</html>