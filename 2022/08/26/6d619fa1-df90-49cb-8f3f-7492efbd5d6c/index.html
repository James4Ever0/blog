<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>on building the lua torch library | Blog of James Brown</title>
  <meta name="author" content="James Brown">
  
  <meta name="description" content="In this article, you will learn how to install and use im2latex with TensorFlow and PyTorch. Additionally, the article covers important safety precautions and potential hardware damage considerations when running &#39;im2latex-tensorflow&#39;. By following these instructions, you can ensure a safe and successful implementation of im2latex in your TensorFlow or PyTorch projects.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="on building the lua torch library"/>
  <meta property="og:site_name" content="Blog of James Brown"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/blog/atom.xml" title="Blog of James Brown" type="application/atom+xml">
  
  
    <link href="/blog/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/blog/css/themes/cerulean.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/highlight-default.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/google-fonts.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/blog/css/comment.css" media="screen" type="text/css">
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-sham.min.js"></script>
  <![endif]-->

  <script src="/blog/js/jquery-2.0.3.min.js"></script>
  
  
  <!-- analytics -->
  



<meta name="generator" content="Hexo 7.0.0"></head>

<body>
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/blog/">Blog of James Brown</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/blog/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/blog/categories" title="All the categories.">
			  <i class="fa fa-folder"></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/blog/tags" title="All the tags.">
			  <i class="fa fa-tags"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/blog/about" title="About me.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
    <div class="content">
      


	
		<div class="page-header page-header-inverse ">		
			<h1 class="title title-inverse "> on building the lua torch library</h1>
		</div>		
	






<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  
		 <div class="alert alert-success description">
			<i class="fa fa-info-circle"></i> <p>In this article, you will learn how to install and use im2latex with TensorFlow and PyTorch. Additionally, the article covers important safety precautions and potential hardware damage considerations when running ‘im2latex-tensorflow’. By following these instructions, you can ensure a safe and successful implementation of im2latex in your TensorFlow or PyTorch projects.</p>
			
		 </div> <!-- alert -->
	  		

	  <h2 id="im2latex-tensorflow-sucks-looking-for-alternatives"><a href="#im2latex-tensorflow-sucks-looking-for-alternatives" class="headerlink" title="im2latex-tensorflow sucks, looking for alternatives"></a>im2latex-tensorflow sucks, looking for alternatives</h2><p><strong>training on gpu is intensive and will occasionally burn hardware if not careful, doing this on kaggle or modify the software to stop training when gpu goes hot, but we are using trainer here</strong><br><a target="_blank" rel="noopener" href="http://nlp.seas.harvard.edu/code/">harvard nlp showcase</a><br>for those doesn’t provide pretrained models:<br><a target="_blank" rel="noopener" href="https://github.com/guillaumegenthial/im2latex">im2latex</a> in tensorflow, with makefile support, run on tensorflow v1 and python3<br><a target="_blank" rel="noopener" href="https://github.com/luopeixiang/im2latex">im2latex</a> in pytorch, more recent. the dataset has relocated to <a target="_blank" rel="noopener" href="https://zenodo.org/record/56198#.YwtB9PcRU5t">here</a> according to <a target="_blank" rel="noopener" href="https://im2markup.yuntiandeng.com/">official website</a></p>
<h2 id="install-or-run-python2-7-to-run-im2latex-tensorflow"><a href="#install-or-run-python2-7-to-run-im2latex-tensorflow" class="headerlink" title="install or run python2.7 to run im2latex-tensorflow"></a>install or run python2.7 to run <a target="_blank" rel="noopener" href="https://github.com/ArminKaramzade/im2latex">im2latex-tensorflow</a></h2><p>you may need to adapt our modified code to load the weights and test the result against our image.<br>it is reported the performance is poor. maybe it does not worth trying.<br>download tensorflow 0.12.0 for macos <a target="_blank" rel="noopener" href="https://pypi.org/project/tensorflow/0.12.0/#files">here</a><br>visit <a target="_blank" rel="noopener" href="https://docs.conda.io/en/latest/miniconda.html">here</a> to get all miniconda installers<br>to install on macos, download the installer <a target="_blank" rel="noopener" href="https://repo.anaconda.com/miniconda/Miniconda3-latest-MacOSX-x86_64.pkg">here</a><br>some tutorial <a target="_blank" rel="noopener" href="https://blog.balasundar.com/install-older-versions-of-python-using-miniconda-on-mac-m1">here</a> about libmagic as bonus tips</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CONDA_SUBDIR=osx-64 conda create -n py27 python=2.7  <span class="comment"># include other packages here</span></span><br><span class="line"><span class="comment"># ensure that future package installs in this env stick to &#x27;osx-64&#x27;</span></span><br><span class="line">conda activate py27</span><br><span class="line">conda config --<span class="built_in">env</span> --<span class="built_in">set</span> subdir osx-64</span><br></pre></td></tr></table></figure>
<p>after that, do this to get pip on python2.7 (rosetta2)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl https://bootstrap.pypa.io/pip/2.7/get-pip.py -o get-pip.py</span><br><span class="line">python get-pip.py</span><br></pre></td></tr></table></figure>
<p>install tensorflow version below 1, and doing this can be far more easier on linux. maybe we should do this in conda virtual enviorment to prevent conflicts.</p>
<h2 id="we-are-doing-this-for-the-original-lua-implementation-of-im2markup"><a href="#we-are-doing-this-for-the-original-lua-implementation-of-im2markup" class="headerlink" title="we are doing this for the original lua implementation of im2markup"></a>we are doing this for the original lua implementation of <a target="_blank" rel="noopener" href="https://github.com/harvardnlp/im2markup">im2markup</a></h2><p><strong>it works!</strong><br>download libcudnn5 for torch<br>remember to activate torch enviorment by exporting the path to some shell script<br>difference between cudamalloc and cudamallocasync, and that’s some copying and pasting about some generalized template of memory manager function<br>qt4 uses CRLF so convert all text files using dos2unix<br>need to hack qt4 files to build qt4<br>hack luarocks to allow install from local spec file and download repo from github via https<br>hack some lua torch file to be compatible with cuda11<br>about c++ tweaks:<br>add ‘+’ to force type inference<br>force type conversion by using brackets<br>some macro to disable some blocks of code</p>
	  
	</div>

	<!-- recommended posts -->
	

	<div>
  	<center>
	<div class="pagination">
<ul class="pagination">
	 
				
		<li class="prev"><a href="/blog/2022/08/26/4da1c86b-86b6-49c6-a581-6289c6635ec7/" class="alignleft prev"><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
  		

        <li><a href="/blog/archives"><i class="fa fa-archive"></i>Archive</a></li>

		
          <li class="next"><a href="/blog/2022/08/25/af109850-a641-43b8-becc-f8fcc89cde1e/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a></li>
        
	
</ul>
</div>

    </center>
	</div>

    <!-- share -->
    
        
    <div class="bdsharebuttonbox">
        <a href="#" class="bds_more" data-cmd="more"></a>
        <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
        <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
        <a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
        <a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a>
        <a href="#" class="bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
        <a href="#" class="bds_evernotecn" data-cmd="evernotecn" title="分享到印象笔记"></a>
        <a href="#" class="bds_youdao" data-cmd="youdao" title="分享到有道云笔记"></a>
        <a href="#" class="bds_copy" data-cmd="copy" title="分享到复制网址"></a>
    </div>
    <script>
        window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"24"},"share":{}};
        with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
    </script>


        

    
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">Comments</h2>
  
</section>


	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2022-08-26 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/blog/categories/Installation-Instructions/">Installation Instructions<span>1</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/blog/tags/guide/">guide<span>3</span></a></li> <li><a href="/blog/tags/installation/">installation<span>2</span></a></li> <li><a href="/blog/tags/im2latex/">im2latex<span>1</span></a></li> <li><a href="/blog/tags/tensorflow/">tensorflow<span>1</span></a></li> <li><a href="/blog/tags/pytorch/">pytorch<span>2</span></a></li> <li><a href="/blog/tags/hardware-damage/">hardware damage<span>1</span></a></li> <li><a href="/blog/tags/safety-precautions/">safety precautions<span>1</span></a></li>

    </ul>
	</div>
	

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->




    </div>
  </div>
  <div class="container-narrow">
    <footer> <p>
  &copy; 2023 James Brown
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a target="_blank" rel="noopener" href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
  </div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/blog/js/jquery.imagesloaded.min.js"></script>
<script src="/blog/js/gallery.js"></script>
<script src="/blog/js/bootstrap.min.js"></script>
<script src="/blog/js/main.js"></script>
<script src="/blog/js/search.js"></script> 


<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/blog/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/blog/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>


<!-- syntax highlighting -->


</body>
</html>